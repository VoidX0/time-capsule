---
title: 配置项
description: 部署时的配置项说明
---

import {TypeTable} from 'fumadocs-ui/components/type-table';

## 配置说明
- ⚙️ 所有配置项均在`[api部署位置]/appsettings.toml`中进行配置，或通过环境变量覆盖。
- 🔑 配置项分为多个部分，使用环境变量覆盖时，采用`Section__Key`的形式，
例如覆盖`SystemOptions`部分的`Instance`配置项，使用环境变量`SystemOptions__Instance`进行覆盖。

## 所有配置项

### `SerilogUI`配置
- 📝 SerilogUI是后端用于查看和管理Serilog日志的Web界面。

<TypeTable
    type={{
        UserName: {
            description: 'SerilogUI的用户名',
            type: 'string',
            default: 'root',
        },
        Password: {
            description: 'SerilogUI的密码',
            type: 'string',
            default: 'time_capsule',
        },
    }}
/>

### `SystemOptions`配置
- ⚙️ 系统配置项，主要用于配置系统的基本信息和路径。

<TypeTable
    type={{
        Instance: {
            description: '实例名称',
            type: 'string',
            default: '',
        },
        StoragePath: {
            description: '持久化存储路径',
            type: 'string',
            default: '/app/storage',
        },
        CameraPath: {
            description: '摄像头基础路径',
            type: 'string',
            default: '/camera',
        },
        CachePath: {
            description: '缓存基础路径',
            type: 'string',
            default: '/cache',
        },
        ApiLogs: {
            description: '是否启用API日志UI',
            type: 'boolean',
            default: 'true',
        },
        ApiReference: {
            description: '是否启用API参考UI',
            type: 'boolean',
            default: 'true',
        },
        ApiHangfire: {
            description: '是否启用Hangfire Dashboard',
            type: 'boolean',
            default: 'true',
        },
        DefaultUser: {
            description: '默认用户名',
            type: 'string',
            default: 'root',
        },
        DefaultPassword: {
            description: '默认密码',
            type: 'string',
            default: 'time_capsule',
        },
        CronSyncAndCache: {
            description: '视频元数据同步/重建缓存的定时任务',
            type: 'string',
            default: '0 0 15 * * *',
        },
        CronFrameDetect:{
            description: '检测画面目标的定时任务',
            type: 'string',
            default: '0 0 9 * * *',
        }
    }}
/>

### `ConnectionOptions`配置
- 🔌 连接配置项，主要用于配置数据库连接和日志服务。

<TypeTable
    type={{
        DbConnection: {
            description: '数据库连接字符串',
            type: 'string',
            default: 'HOST=postgres; PORT=5432; DATABASE=api_db; USER ID=root; PASSWORD=root;',
        },
        LogServer: {
            description: '日志服务地址，如: "http://loki:3100"，为空时仅使用本地日志',
            type: 'string',
            default: '',
        },
    }}
/>

### `TokenOptions`配置
- 🔑 Token配置项，主要用于配置JWT令牌的相关信息。

<TypeTable
    type={{
        AesKey: {
            description: 'AES加密密钥',
            type: 'string',
            default: 'hqFbWJOAztOfRxXRsMDI6oJVVbjIYB92hnFNyZFM/14=',
        },
        AesIv: {
            description: 'AES偏移',
            type: 'string',
            default: '1mSh76L5ueVr0GN7NGIkTA==',
        },
        Secret: {
            description: 'JWT密钥',
            type: 'string',
            default: 'Develop-TimeCapsuleApi-Secret-Key',
        },
        Issuer: {
            description: '令牌发行者',
            type: 'string',
            default: 'developer',
        },
        Audience: {
            description: '令牌受众',
            type: 'string',
            default: 'developer',
        },
        AccessExpiration: {
            description: '访问令牌过期时间(小时)',
            type: 'number',
            default: '24',
        },
    }}
/>

### `OidcOptions`配置
- 🌐 OIDC配置项，主要用于配置OpenID Connect相关信息。
- ⚠️配置信息不完整时，OIDC登录功能将被禁用。

<TypeTable
    type={{
        RedirectUri: {
            description: '重定向到后端的地址',
            type: 'string',
            default: '',
        },
        ClientId: {
            description: '客户端ID',
            type: 'string',
            default: '',
        },
        ClientSecret: {
            description: '客户端密钥',
            type: 'string',
            default: '',
        },
        AuthorizationEndpoint: {
            description: '授权端点',
            type: 'string',
            default: '',
        },
        TokenEndpoint: {
            description: '令牌端点',
            type: 'string',
            default: '',
        },
        UserInfoEndpoint: {
            description: '用户信息端点',
            type: 'string',
            default: '',
        },
    }}
/>

### `SmtpOptions`配置
- 📧 SMTP邮箱配置项，主要用于配置SMTP服务器和邮件模版。

<TypeTable
    type={{
        Server: {
            description: 'SMTP服务器地址',
            type: 'string',
            default: 'smtp.163.com',
        },
        Port: {
            description: 'SMTP服务器端口',
            type: 'number',
            default: '587',
        },
        EnableSsl: {
            description: '是否启用SSL',
            type: 'boolean',
            default: 'true',
        },
        Username: {
            description: '邮箱用户名',
            type: 'string',
            default: '',
        },
        Password: {
            description: '邮箱密码/授权码',
            type: 'string',
            default: '',
        },
        Title: {
            description: '邮件标题',
            type: 'string',
            default: '时间胶囊',
        },
        TemplateRegisterConfirm: {
            description: '注册确认模版，$code为验证码占位符',
            type: 'string',
            default: '验证码$code，您正在注册成为新用户，感谢您的支持！',
        },
        TemplateLoginConfirm: {
            description: '登录确认模版，$code为验证码占位符',
            type: 'string',
            default: '验证码$code，您正在登录，若非本人操作，请勿泄露。',
        },
    }}
/>